{"name":"Phync","tagline":"Simple rsync wrapper in PHP","body":"Phync\r\n=====\r\n\r\ndevelop: [![Build Status](https://travis-ci.org/yuya-takeyama/phync.png?branch=develop)](https://travis-ci.org/yuya-takeyama/phync)\r\nmaster: [![Build Status](https://travis-ci.org/yuya-takeyama/phync.png?branch=master)](https://travis-ci.org/yuya-takeyama/phync)\r\n\r\nPHP による `rsync` ラッパ\r\n\r\nFeatures\r\n--------\r\n\r\n1. `rsync` のラッパとして動作し、複雑な `rsync` コマンドを簡単に生成・実行できる。\r\n2. 複数のサーバにまとめてシンクできる。\r\n3. プロジェクトルートから全体のシンクができる。\r\n4. プロジェクトツリー内の一部のファイル・ディレクトリだけを選択してシンクできる。\r\n5. デフォルト動作は `rsync --dry-run` となっており、確認が安全に行える。\r\n\r\nInstallation\r\n------------\r\n\r\n### phync 本体\r\n\r\nGitHub から `git` コマンドで直接インストールできます。  \r\nワークツリーの `./bin` ディレクトリを `$PATH` に追加することで `phync` コマンドが使用できるようになります。\r\n\r\n```\r\n$ git clone https://github.com/yuya-takeyama/phync.git ~/.phync\r\n```\r\n\r\nGitHub の Subversion インターフェイスを使用すれば `svn` コマンドでもインストールできます。\r\n\r\n```\r\n$ svn co https://github.com/yuya-takeyama/phync/trunk ~/.phync\r\n```\r\n\r\n### 各プロジェクトへのインストール\r\n\r\n各プロジェクトごとに設定ファイル、ログディレクトリを設置する必要があります。\r\n\r\n`phync` コマンドの実行時に、カレントディレクトリ内の `.phync/config.php` を読み込みます。\r\n\r\nまた、ログディレクトリはデフォルトでは `.phync/log` となっており、予め作成しておく必要があります。\r\n\r\nUsage\r\n-----\r\n\r\n### ドライラン\r\n\r\nデフォルトの動作は `rsync --dry-run` によるドライランです。  \r\nドライランを行うと、実行時にどのような変更が行われるかを確認できます。  \r\n\r\n引数を指定しなければ、プロジェクト全体が対象となります。\r\n\r\n```\r\n$ phync\r\n# 以下のようなコマンドが生成される\r\n# rsync -av --dry-run --delete '/project/' 'example.com:/project/'\r\n```\r\n\r\n引数を指定することで、一部のファイル・ディレクトリのみを対象とすることができます。  \r\nまた、同時に複数のファイル・ディレクトリを指定することが出来ます。\r\n\r\n```\r\n# ファイル\r\n$ phync path/to/file\r\n# 以下のようなコマンドが生成される\r\n# rsync -av --dry-run --delete '/project/' 'example.com:/project/' --include '/path/to/file' --include '/path/to/' --include '/path/' --exclude '*'\r\n\r\n# ディレクトリ\r\n$ phync path/to/dir\r\n# 以下のようなコマンドが生成される\r\n# rsync -av --dry-run --delete '/project/' 'example.com:/project/' --include '/path/to/dir/' --include '/path/to/dir/*' --include '/path/to/dir/**/*' --exclude '*'\r\n\r\n# 複数まとめて\r\n$ phync path/to/file path/to/dir\r\n# 以下のようなコマンドが生成される\r\n# rsync -av --dry-run --delete '/project/' 'example.com:/project/' --include '/path/to/file' --include '/path/to/' --include '/path/' --include '/path/to/dir/' --include '/path/to/dir/*' --include '/path/to/dir/**/*' --exclude '*'\r\n```\r\n\r\n### シンクの実行\r\n\r\n`phync` コマンドの実行時に `--execute` オプションを付加することで、シンクが実行されます。\r\n\r\nこのとき生成される `rsync` コマンドは、ドライラン時のものから `--dry-run` オプションのみが除かれたものです。\r\n\r\n```\r\n# ファイル\r\n$ phync --execute path/to/file\r\n\r\n# ディレクトリ\r\n$ phync --execute path/to/dir\r\n\r\n# 複数まとめて\r\n$ phync --execute path/to/file path/to/dir\r\n```\r\n\r\nConfiguration\r\n-------------\r\n\r\nカレントディレクトリ内の `.phync/config.php` が設定ファイルとなります。  \r\n設定値は PHP の連想配列として記述できます。\r\n\r\n### 設定ファイルの記述例\r\n\r\n```php\r\n<?php\r\nreturn array(\r\n    'destinations' => array(\r\n        'foo.example.com',\r\n        'bar.example.com',\r\n        'baz.example.com',\r\n    ),\r\n    'exclude_from' => 'exclude.lst',\r\n    'rsync_path'   => '/usr/bin/rsync',\r\n    'rsh'          => '/usr/bin/ssh',\r\n);\r\n```\r\n\r\n### 各設定値の詳細\r\n\r\n項目名             |説明                                                                                            |必須|設定例                                               |\r\n-------------------|------------------------------------------------------------------------------------------------|----|-----------------------------------------------------|\r\ndestinations       |シンク先サーバのホスト名を配列で指定する。                                                      |Yes |`array('server1.example.net', 'server2.example.net')`|\r\nssh\\_user          |対象ホストへの接続に使用する SSH ユーザ名。                                                     |No  |`'testuser'`                                         |\r\nremote\\_target\\_dir|リモートの対象ディレクトリへのパス。デフォルトではローカルのカレントと同じパスが対象となる。    |No  |`'/path/to/target-directory'`                        |\r\nexclude\\_from      |`rsync` コマンドの `--exclude-from` オプション。除外ファイルの一覧を記述したファイルを指定する。|No  |`dirname(__FILE__) . '/rsync_exclude'`               |\r\nrsync\\_path        |`rsync` コマンドの `--rsync-path` オプション。                                                  |No  |`'/usr/bin/rsync'`                                   |\r\nrsh                |`rsync` コマンドの `--rsh` オプション。                                                         |No  |`'/usr/bin/ssh'`                                     |\r\ndefault\\_checksum  |`true` にすると `rsync` コマンドに `--checksum` オプションが付加される。デフォルトは `false`。  |No  |`true`                                               |\r\nlog\\_directory     |ログファイルを保存するディレクトリのパス。でフォルトは `.phync/log`                             |No  |`'/path/to/log-directory'`                           |\r\n\r\n### 設定ファイルパスの指定\r\n\r\nv0.5.0 より `--config=FILE` オプションを指定することで、デフォルトとは別の設定ファイルを読み込めるようになりました。\r\n\r\nAuthor\r\n------\r\n\r\nYuya Takeyama\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}